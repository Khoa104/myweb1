<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>D·ª± B√°o B√°n H√†ng</title>
  <style>
    body {
      font-family: Arial;
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    input, select, button {
      margin: 5px 0;
      padding: 8px;
      width: 100%;
    }
    table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>

  <h2>Form Nh·∫≠p D·ª± B√°o B√°n H√†ng</h2>

  <label>T√™n s·∫£n ph·∫©m:</label>
  <input type="text" id="productName" placeholder="V√≠ d·ª•: B√°nh m√¨">

  <label>Th√°ng:</label>
  <select id="month">
    <option value="">-- Ch·ªçn th√°ng --</option>
    <option value="01">Th√°ng 1</option>
    <option value="02">Th√°ng 2</option>
    <option value="03">Th√°ng 3</option>
    <option value="04">Th√°ng 4</option>
    <option value="05">Th√°ng 5</option>
    <option value="06">Th√°ng 6</option>
    <option value="07">Th√°ng 7</option>
    <option value="08">Th√°ng 8</option>
    <option value="09">Th√°ng 9</option>
    <option value="10">Th√°ng 10</option>
    <option value="11">Th√°ng 11</option>
    <option value="12">Th√°ng 12</option>
  </select>

  <label>S·ªë l∆∞·ª£ng d·ª± b√°o:</label>
  <input type="number" id="forecastQty" placeholder="V√≠ d·ª•: 1000">

  <button onclick="addForecast()">Th√™m d·ª± b√°o</button>
  <button onclick="clearForecast()">üóë Xo√° to√†n b·ªô</button>

  <h3>D·ªØ li·ªáu d·ª± b√°o ƒë√£ l∆∞u:</h3>
  <table id="forecastTable">
    <thead>
      <tr>
        <th>S·∫£n ph·∫©m</th>
        <th>Th√°ng</th>
        <th>S·ªë l∆∞·ª£ng</th>
      </tr>
    </thead>
    <tbody>
      <!-- D·ªØ li·ªáu s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
    </tbody>
  </table>
  <button onclick="downloadCSV()">üì§ Xu·∫•t file Excel</button>

  <script>
    // H√†m hi·ªÉn th·ªã d·ªØ li·ªáu t·ª´ localStorage ra b·∫£ng
    function loadForecast() {
      const data = JSON.parse(localStorage.getItem("forecasts")) || [];
      const table = document.getElementById("forecastTable").getElementsByTagName("tbody")[0];
      table.innerHTML = ""; // xo√° c≈© tr∆∞·ªõc khi render l·∫°i

      data.forEach((item) => {
        const newRow = table.insertRow();
        newRow.innerHTML = `<td>${item.name}</td><td>${item.month}</td><td>${item.qty}</td>`;
      });
    }

    // H√†m th√™m d·ª± b√°o m·ªõi
    function addForecast() {
      const name = document.getElementById("productName").value;
      const month = document.getElementById("month").value;
      const qty = document.getElementById("forecastQty").value;

      if (!name || !month || !qty) {
        alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!");
        return;
      }

      const newForecast = { name, month, qty };

      // L·∫•y d·ªØ li·ªáu c≈© t·ª´ localStorage, r·ªìi th√™m m·ªõi
      const forecasts = JSON.parse(localStorage.getItem("forecasts")) || [];
      forecasts.push(newForecast);
      localStorage.setItem("forecasts", JSON.stringify(forecasts));

      loadForecast(); // c·∫≠p nh·∫≠t b·∫£ng
      document.getElementById("productName").value = "";
      document.getElementById("month").value = "";
      document.getElementById("forecastQty").value = "";
    }

    // H√†m x√≥a to√†n b·ªô d·ªØ li·ªáu
    function clearForecast() {
      if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën xo√° to√†n b·ªô d·ªØ li·ªáu?")) {
        localStorage.removeItem("forecasts");
        loadForecast();
      }
    }

    // T·ª± ƒë·ªông hi·ªÉn th·ªã l·∫°i d·ªØ li·ªáu khi m·ªü trang
    window.onload = loadForecast;

    function downloadCSV() {
  const data = JSON.parse(localStorage.getItem("forecasts")) || [];
  if (data.length === 0) {
    alert("Ch∆∞a c√≥ d·ªØ li·ªáu ƒë·ªÉ xu·∫•t!");
    return;
  }

  // T·∫°o n·ªôi dung CSV
  let csv = "T√™n s·∫£n ph·∫©m,Th√°ng,S·ªë l∆∞·ª£ng\n";
  data.forEach((item) => {
    csv += `${item.name},${item.month},${item.qty}\n`;
  });

  // T·∫°o file v√† t·∫£i v·ªÅ
  const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "du-bao-ban-hang.csv";
  link.click();
  URL.revokeObjectURL(link.href); // Gi·∫£i ph√≥ng b·ªô nh·ªõ
  alert("ƒê√£ t·∫£i file CSV v·ªÅ m√°y!"); 
  }

  </script>

</body>
</html>
